

## canvas ç”»ç›´çº¿

1.  è·å–ç”»å¸ƒ
2. è·å–ç”»å¸ƒçš„ä¸Šä¸‹æ–‡
3. å¼€å§‹ä¸€æ¡è·¯å¾„
4. ç¡®å®šèµ·å§‹ç‚¹
5. ç¡®å®šç»“æŸç‚¹
6. ç€è‰²
7. ç»“æŸè·¯å¾„

```js
let canvas = document.querySelector('#canvas');
let ctx = canvas.getContext('2d');
ctx.beginPath();
ctx.moveTo(100, 100);
ctx.lineTo(400, 400);
ctx.strokeStyle = 'green';
ctx.lineWidth = '5'
ctx.stroke();
ctx.closePath();

// è¿›è¡Œå°è£…
// å›ºå®šå¼€å§‹
let canvas = document.querySelector('#canvas');
let ctx = canvas.getContext('2d');
// å›ºå®šç»“æŸ
drawLine(100,100, 400, 100, 'red', 4);
drawLine(400,100, 400, 400, 'blue', 4);
drawLine(400,400, 100, 400, 'yellow', 4);
drawLine(100, 400, 100, 100, 'purple', 4);
function drawLine(x1,y1, x2,y2,color, width) {
  ctx.beginPath();
  ctx.moveTo(x1,y1);
  ctx.lineTo(x2,y2);
  ctx.strokeStyle = color;
  ctx.lineWidth = width;
  ctx.stroke();
  ctx.closePath();
}
// ç”»è™šçº¿
for (let i = 0; i < 30; i++) {
  drawLine(100+10*i, 100+ 10*i, 105+ 10*i, 105+ 10*i, 'green', 2)
}
```



å¸¸ç”¨æ–¹æ³•å’Œå±æ€§:

1. ç”»ç›´çº¿

   * `beginPath` å¼€å¯ä¸€ä¸ªè·¯å¾„
   * `closePath` å…³é—­ä¸€ä¸ªè·¯å¾„
   * `moveTo(x,y)`  å®šä¹‰çº¿æ¡å¼€å§‹åæ ‡
   * `lineTo(x,y)`  å®šä¹‰çº¿æ¡ç»“æŸåæ ‡
   * `strokeStyle` å±æ€§è®¾ç½®æˆ–è€…è¿”å›ç”¨äºç¬”è§¦çš„é¢œè‰²ã€æ¸å˜æˆ–æ¨¡å¼
   * `stroke` ç»˜åˆ¶ä¸€æ¡è·¯å¾„
   * `lineWidth`  è®¾ç½®çº¿å®½

2.  ç”»çŸ©å½¢

   * `rect(x,y, width, height)` : ç»˜åˆ¶çŸ©å½¢
   * `fillRect(x,y, width, height)`: ç»˜åˆ¶å®å¿ƒçŸ©å½¢
   * `strokeRect(x,y,width, height)`: ç»˜åˆ¶ç©ºå¿ƒçŸ©å½¢

   ```js
   // ç”»çŸ©å½¢
   let canvas1 = document.querySelector('#canvas1');
   let ctx1 = canvas1.getContext('2d');
   
   ctx1.beginPath();
   ctx1.moveTo(100, 100);
   ctx1.lineTo(100, 400);
   ctx1.lineTo(400, 400);
   ctx1.stroke();
   ctx1.closePath();
   
   // ç”»æŸ±çŠ¶å›¾ ğŸ“Š
   for (let i = 0; i < 7; i++) {
     let height = Math.random()* 280 + 10;
     // ctx1.fillStyle='#'+ parseInt(Math.random()*0xffffff).toString(16);
     ctx1.fillStyle = `rgb(${parseInt(Math.random() * 256)},${parseInt(Math.random() * 256)},${parseInt(Math.random() * 256)})`
     ctx1.fillRect(120+ 40*i, 400- height, 20, height)
   }
   ```

   

3. æ¸…é™¤ç”»å¸ƒ

   * `clearRect(x,y, width, height)` : æ¸…é™¤ç”»å¸ƒ

4. ç”»åœ†

   ![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3587a584b9d14d09af577e6e16c6be41~tplv-k3u1fbpfcp-watermark.image)

   * `arc(x, y, radius, startAngle, endAngle, counterclockwise)`

     > x,y æè¿°å¼§çš„åœ†å½¢çš„åœ†å¿ƒçš„åæ ‡
     >
     > Radius  æè¿°å¼§çš„åœ†å½¢çš„åŠå¾„
     >
     > startAngle, endAngle
     >
     > æ²¿ç€åœ†æŒ‡å®šå¼§çš„å¼€å§‹ç‚¹å’Œç»“æŸç‚¹çš„ä¸€ä¸ªè§’åº¦ï¼Œè¿™ä¸ªè§’åº¦ç”¨å¼§åº¦æ¥è¡¡é‡
     >
     > æ²¿ç€ X è½´æ­£åŠè½´çš„ä¸‰ç‚¹é’Ÿæ–¹å‘çš„è§’åº¦ä¸º 0ï¼Œ è§’åº¦æ²¿ç€é€†æ—¶é’ˆæ–¹å‘è€Œå¢åŠ 
     >
     > counterclockwise : å¼§æ²¿ç€åœ†å‘¨çš„é€†æ—¶é’ˆæ–¹å‘ï¼ˆtrueï¼‰è¿˜æ˜¯é¡ºæ—¶é’ˆæ–¹å‘ï¼ˆfalseï¼‰éå†

     ```js
      // ç”»åœ†/ å¼§
     let canvas2 = document.querySelector('#canvas2');
     let ctx2 = canvas2.getContext('2d');
     ctx2.beginPath();
     ctx2.arc(100, 100, 100, 0, Math.PI / 180 * 180, false);
     ctx2.stroke();
     
     ctx2.beginPath();
     ctx2.arc(300,100,100,0, Math.PI, true);
     ctx2.stroke();
     // åŒå¿ƒåœ†
     ctx2.beginPath();
     ctx2.arc(250, 250, 100, 0, Math.PI *2 , true);
     ctx2.stroke();
     
     ctx2.beginPath();
     ctx2.arc(250, 250, 120, 0, Math.PI * 2 , true);
     ctx2.stroke();
     
     ctx2.beginPath();
     ctx2.arc(250, 250, 140, 0, Math.PI * 2, true);
     ctx2.stroke();
     // ç”»ä¸€ä¸ªèŒ¶æ¯
     let canvas3 = document.querySelector('#canvas3');
     let ctx3 = canvas3.getContext('2d');
     // ç”»èŒ¶æ¯èº«ä½“
     ctx3.lineWidth = 3;
     ctx3.strokeRect(100, 200, 200, 200);
     // èŒ¶æ¯æŠŠæ‰‹
     drawCircle(ctx3, 300,300, 50, 10, false, 'orange');
     // å†’çš„çƒ­æ°”
     for (let i = 0; i < 4; i++) {
       drawCircle(ctx3, 130+ i* 40, 120, 20, 1, true);
       drawCircle(ctx3, 130 + i * 40, 160, 20, 1, false);
     }
     
     function drawCircle (ctx, x,y, radius, width, flag, color) {
       ctx.beginPath();
       ctx.arc(x,y, radius, -Math.PI/2, Math.PI/2, flag);
       ctx.lineWidth = width;
       ctx.strokeStyle = color || '#000';
       ctx.stroke();
     }
     ```

     

5. ç”»æ–‡å­—

   * `fillText()`  æ–¹æ³•åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å¡«è‰²çš„æ–‡æœ¬ã€‚ é»˜è®¤é¢œè‰²æ˜¯é»‘è‰²
     `fillText(text, x, y, maxWidth)`; 
     `maxWidth` : å…è®¸çš„æœ€å¤§æ–‡æœ¬å®½åº¦ï¼Œ ä»¥åƒç´ è®¡

   * `strokeText()` æ–¹æ³•åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶ç©ºå¿ƒçš„é—®é¢˜ï¼Œæ–¹æ³•é€š `fillText()`

   * `createLinearGradient()`  æ–¹æ³•åˆ›å»ºçº¿æ€§çš„æ¸å˜å¯¹è±¡ã€‚ æ¸å˜å¯ç”¨äºå¡«å……çŸ©å½¢ã€åœ†å½¢ã€çº¿æ¡ã€æ–‡æœ¬ç­‰ç­‰ï¼Œä½¿ç”¨è¯¥å¯¹è±¡ä½œä¸º `strokeStyle` æˆ– `fillStyle` å±æ€§çš„å€¼

   * ä½¿ç”¨ `addColorStop()` æ–¹æ³•è§„å®šä¸åŒçš„é¢œè‰²ï¼Œä»¥åŠåœ¨ `gradient`  å¯¹è±¡ä¸­çš„ä½•å¤„å®šä½é¢œè‰² 

   * `font=value`  å½“å‰æˆ‘ä»¬ç”¨æ¥ç»˜åˆ¶æ–‡æœ¬çš„æ ·å¼. è¿™ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨å’Œ [CSS](https://developer.mozilla.org/en-US/docs/Web/CSS) [`font`](https://developer.mozilla.org/zh-CN/docs/Web/CSS/font) å±æ€§ç›¸åŒçš„è¯­æ³•. é»˜è®¤çš„å­—ä½“æ˜¯ `10px sans-serif`ã€‚

   * `textAlign=value` æ–‡æœ¬å¯¹é½é€‰é¡¹. å¯é€‰çš„å€¼åŒ…æ‹¬ï¼š`start`, `end`, `left`, `right` or `center`. é»˜è®¤å€¼æ˜¯ `start`ã€‚

   * `textBaseline = value` åŸºçº¿å¯¹é½é€‰é¡¹. å¯é€‰çš„å€¼åŒ…æ‹¬ï¼š`top`, `hanging`, `middle`, `alphabetic`, `ideographic`, `bottom`ã€‚é»˜è®¤å€¼æ˜¯ `alphabeticã€‚`

   * `direction = value` æ–‡æœ¬æ–¹å‘ã€‚å¯èƒ½çš„å€¼åŒ…æ‹¬ï¼š`ltr`, `rtl`, `inherit`ã€‚é»˜è®¤å€¼æ˜¯ `inheritã€‚`

   * `measureText()`  å°†è¿”å›ä¸€ä¸ª [`TextMetrics`](https://developer.mozilla.org/zh-CN/docs/Web/API/TextMetrics)å¯¹è±¡çš„å®½åº¦ã€æ‰€åœ¨åƒç´ ï¼Œè¿™äº›ä½“ç°æ–‡æœ¬ç‰¹æ€§çš„å±æ€§ã€‚

   * `setLineDash` Canvas 2D APIçš„[`CanvasRenderingContext2D`](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D)æ¥å£çš„**`setLineDash()`**æ–¹æ³•åœ¨å¡«å……çº¿æ—¶ä½¿ç”¨è™šçº¿æ¨¡å¼ã€‚ å®ƒä½¿ç”¨ä¸€ç»„å€¼æ¥æŒ‡å®šæè¿°æ¨¡å¼çš„çº¿å’Œé—´éš™çš„äº¤æ›¿é•¿åº¦ã€‚**æç¤ºï¼š**å¦‚æœè¦åˆ‡æ¢å›è‡³å®çº¿æ¨¡å¼ï¼Œå°† dash list è®¾ç½®ä¸ºä¸€ä¸ªç©ºæ•°ç»„å³å¯ã€‚

     > ```js
     > void ctx.setLineDash(segments);
     > 
     > segments ï¼š  array
     > ä¸€ç»„æè¿°äº¤æ›¿ç»˜åˆ¶çº¿æ®µå’Œé—´è·ï¼ˆåæ ‡ç©ºé—´å•ä½ï¼‰é•¿åº¦çš„æ•°å­—ã€‚ å¦‚æœæ•°ç»„å…ƒç´ çš„æ•°é‡æ˜¯å¥‡æ•°ï¼Œ æ•°ç»„çš„å…ƒç´ ä¼šè¢«å¤åˆ¶å¹¶é‡å¤ã€‚ä¾‹å¦‚ï¼Œ `[5, 15, 25]` ä¼šå˜æˆ `[5, 15, 25, 5, 15, 25]ã€‚
     > ```

   ```js
    // ç»˜åˆ¶æ–‡å­—
   let canvas5 = document.querySelector('#canvas5');
   let ctx5 = canvas5.getContext('2d');
   ctx5.font = '50px å®‹ä½“';
   ctx5.fillStyle = 'gold';
   ctx5.fillText('hello', 50, 100);
   // ç»˜åˆ¶ç©ºå¿ƒæ–‡å­—
   ctx5.strokeStyle = 'red';
   ctx5.strokeText('ä½ å¥½', 0, 200);
   // è®¾ç½®æœ€å¤§å®½åº¦// ç»˜åˆ¶ç©ºå¿ƒæ–‡å­—
   ctx5.strokeStyle = 'blue';
   ctx5.strokeText('ä½ å¥½', 200, 200, 100);
   // è®¾ç½®çº¿æ€§æ¸å˜
   let gradient = ctx5.createLinearGradient(0, 0, canvas5.width, 0);
   gradient.addColorStop(0, 'yellow');
   gradient.addColorStop(0.5, 'blue');
   gradient.addColorStop(1, 'red');
   ctx5.fillStyle = gradient;
   ctx5.fillText('ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œæƒ³å‡ºå»ç©', 30, 300, 300);
   ctx5.strokeStyle = gradient;
   ctx5.strokeText('è¿™å¤©æ°”ä¸é’“é±¼å¯æƒœäº†äº†ã€‚ã€‚ã€‚ã€‚', 30, 370, 300);
   
   // è°ƒæ•´æ–‡å­—çš„æ ·å¼
   let canvas6 = document.querySelector('#canvas6');
   let ctx6 = canvas6.getContext('2d');
   ctx6.beginPath();
   ctx6.moveTo(205, 0);
   ctx6.lineTo(205, 410);
   ctx6.stroke();
   
   ctx6.beginPath();
   ctx6.moveTo(0, 205);
   ctx6.lineTo(410, 205);
   ctx6.stroke();
   ctx6.closePath();
   
   ctx6.font = '30px å¾®è½¯é›…é»‘';
   // 'start | left | center | right |end'
   ctx6.textAlign = 'center';
   // 'top | hanging | middle | alphabetic | ideographic | bottom';
   ctx6.textBaseline='middle';
   
   ctx6.fillText('HTML5', 205, 205);
   // ç”»ä¸€ä¸ª â€™ç±³â€˜ å­—
   let canvas7 = document.querySelector('#canvas7');
   let ctx7 = canvas7.getContext('2d');
   // ç”»å®çº¿
   drawLine(ctx7, 0, 205, 410, 205);
   drawLine(ctx7, 205, 0, 205, 410);
   // ç”»è™šçº¿ (æ–¹æ³•ä¸€ï¼š)
   // for (let i = 0; i < 410; i+=10) {
   //     drawLine(ctx7, i+0, i+0, i+5, i+5, 'red');
   //     drawLine(ctx7, 410 - i + 0, i + 0, 410 - (i + 5), i + 5, 'red');
   // }
   // ç”»è™šçº¿ (æ–¹æ³•äºŒï¼š)
   ctx7.setLineDash([5, 5]);
   drawLine(ctx7, 0, 0, 410, 410, 'red');
   drawLine(ctx7, 0, 410, 410, 0, 'red');
   
   // ç”»æ–‡å­—
   drawText(ctx7, 'ç±³', 205, 205)
   function drawText (ctx, text, x, y) {
     ctx.font = '300px åæ–‡æ¥·ä½“';
     ctx.textAlign = 'center';
     ctx.textBaseline = 'middle';
     ctx.fillText(text, x, y);
   }
   ```

6. ç»˜åˆ¶å›¾ç‰‡

   * `drawImage()` åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å›¾åƒã€ç”»å¸ƒæˆ–è§†é¢‘ï¼Œä¹Ÿèƒ½ç»˜åˆ¶å›¾åƒçš„æŸäº›éƒ¨åˆ†ï¼Œæˆ–è€…å¢åŠ æˆ–è€…å‡å°å›¾åƒçš„å°ºå¯¸

     * è¯­æ³•1ï¼š `context.drawImage(img, x, y) `   åœ¨ç”»å¸ƒä¸Šå®šä½å›¾åƒ
     * è¯­æ³•2ï¼š `context.drawIamge(img,x, y, width, height) `   åœ¨ç”»å¸ƒä¸Šå®šä½å›¾åƒï¼Œå¹¶è§„å®šå›¾åƒçš„å®½åº¦å’Œé«˜åº¦
     * è¯­æ³•3ï¼š `context.drawImage(img,sx,sy,swidth,sheight,x,y,width,height)` è£å‰ªå¥½å›¾ç‰‡æ”¾ç½®äºç”»å¸ƒå“ªä¸ªä½ç½®

   * `getImageData()`  è¿”å› `ImageData`  å¯¹è±¡ï¼Œ è¯¥å¯¹è±¡æ‹·è´äº†ç”»å¸ƒæŒ‡å®šçŸ©å½¢çš„åƒç´ æ•°æ®ã€‚å¯¹äº `ImageData` å¯¹è±¡ä¸­çš„æ¯ä¸ªåƒç´ ï¼Œå››ä¸ªæ•°ä¸ºä¸€ç»„ï¼Œå³RGBA å€¼

     ```js
     let imageData = context.getImageData(x, y, width, height)
     ```

   * `putImageData()` 

     ```js
     putImageData(imgData, x, y, dirtyX, dirtyY, dirtyWidth, dirtyHeight)
     imgData  è§„å®šè¦æ”¾å›ç”»å¸ƒçš„ ImageData å¯¹è±¡
     x       ImageData å¯¹è±¡å·¦ä¸Šè§’çš„ x åæ ‡ï¼Œ ä»¥åƒç´ è®¡
     y       ImageData å¯¹è±¡å·¦ä¸Šè§’çš„ y åæ ‡ï¼Œ ä»¥åƒç´ è®¡
     dirtyX   å¯é€‰ã€‚ æ°´å¹³å€¼ ï¼ˆxï¼‰, ä»¥åƒç´ è®¡ï¼Œ åœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ä½ç½®
     dirtyY   å¯é€‰ã€‚ æ°´å¹³å€¼ ï¼ˆyï¼‰, ä»¥åƒç´ è®¡ï¼Œåœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ä½ç½®
     dirtyWidth  å¯é€‰ï¼Œåœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å›¾åƒæ‰€ä½¿ç”¨çš„çš„å®½åº¦
     dirtyHeight å¯é€‰ï¼Œåœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å›¾åƒæ‰€ä½¿ç”¨çš„çš„é«˜åº¦
     ```

     

